{"version":3,"file":"http.js","sourceRoot":"","sources":["../../../src/http/http.ts"],"names":[],"mappings":";;;IAEA,IAAK,SAGJ;IAHD,WAAK,SAAS;QACZ,wBAAa,CAAA;QACb,0BAAc,CAAA;IAChB,CAAC,EAHI,SAAS,KAAT,SAAS,QAGb;IAAA,CAAC;IAEF;QAAA;QAsDA,CAAC;QApDC,kBAAG,GAAH,UAAI,QAAe;YAAnB,iBAMC;YALC,OAAO,IAAI,OAAO,CAAE,UAAC,OAAO,EAAC,MAAM;gBACjC,IAAI,KAAK,GAAkB,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,EAAC,QAAQ,CAAC,CAAC;gBACpE,KAAI,CAAC,kBAAkB,CAAC,KAAK,EAAC,OAAO,EAAC,MAAM,CAAC,CAAC;gBAC9C,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,kBAAkB;YAClC,CAAC,CAAC,CAAC;QACL,CAAC;QAED;;;;WAIG;QACK,0BAAW,GAAnB,UAAoB,IAAe,EAAE,QAAe;YAElD,IAAM,KAAK,GAAG,IAAI,cAAc,EAAE,CAAC,CAAC,oDAAoD;YACxF,KAAK,CAAC,IAAI,CAAE,IAAI,EAAG,QAAQ,EAAG,IAAI,CAAC,CAAC;YACpC,OAAO,KAAK,CAAC;QACf,CAAC;QAED;;;;;WAKG;QACK,iCAAkB,GAA1B,UAA2B,KAAqB,EAAE,OAAO,EAAE,MAAM;YAC7D;;;;aAIC;YACH,KAAK,CAAC,kBAAkB,GAAG,UAAS,KAAW;gBAC7C,sBAAsB;gBACtB,IAAG,IAAI,CAAC,UAAU,IAAI,CAAC,EAAC,EAAE,sBAAsB;oBAC9C,qDAAqD;oBACrD,IAAM,QAAQ,GAAY,IAAI,mBAAQ,CAAC,KAAK,CAAC,YAAY,EAAC,KAAK,CAAC,MAAM,CAAC,CAAC;oBAExE,IAAG,IAAI,CAAC,MAAM,IAAI,GAAG,EAAC;wBACpB,OAAO,CAAC,QAAQ,CAAC,CAAC;qBACnB;oBAED,IAAG,IAAI,CAAC,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,IAAI,GAAG,EAAC;wBAC1C,MAAM,CAAC,QAAQ,CAAC,CAAC;qBAClB;iBAEF;YAEH,CAAC,CAAC;QAEJ,CAAC;QAEH,WAAC;IAAD,CAAC,AAtDD,IAsDC","sourcesContent":["import { Response } from \"./response\";\r\n\r\nenum httpVerbs  {\r\n  GET   = 'GET',\r\n  POST  = 'POST'\r\n};\r\n\r\nexport default class Http {\r\n\r\n  get(endpoint:string): Promise<Response>{\r\n    return new Promise( (resolve,reject )=>{\r\n      let xhttp:XMLHttpRequest = this.createXhttp(httpVerbs.GET,endpoint);\r\n      this.configureCallbacks(xhttp,resolve,reject);\r\n      xhttp.send(); // no data to send\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Cria uma requisicao ajax\r\n   * @param verb \r\n   * @param endpoint \r\n   */\r\n  private createXhttp(verb: httpVerbs, endpoint:string)\r\n  {\r\n    const xhttp = new XMLHttpRequest(); // objeto representando requisicoes assicronas(ajax)\r\n    xhttp.open( verb , endpoint , true);\r\n    return xhttp;\r\n  }\r\n\r\n  /**\r\n   * Configura os manipuladores de retorno de sucesso ou falha operantes no objeto XMLHttpRequest\r\n   * @param xhttp \r\n   * @param resolve \r\n   * @param reject \r\n   */\r\n  private configureCallbacks(xhttp: XMLHttpRequest, resolve, reject){\r\n      /**\r\n     * Para pegar a reservada this do contexto do evento é necessario usar a notação com function(){}\r\n     * Usando a notação (event):any=>{} não possui acesso ao this do evento e sim da Classe\r\n     * ref: https://pt.stackoverflow.com/questions/143399/qual-a-diferen%C3%A7a-entre-function-e-por-que-n%C3%A3o-funciona-o-http-ge\r\n     */\r\n    xhttp.onreadystatechange = function(event:Event):void {\r\n      // console.log(event);\r\n      if(this.readyState == 4){ // status OK do client\r\n        // pegando a resposta do server como um tipo Response\r\n        const response:Response = new Response(xhttp.responseText,xhttp.status);\r\n        \r\n        if(this.status == 200){\r\n          resolve(response);\r\n        }\r\n\r\n        if(this.status == 400 || this.status == 500){\r\n          reject(response);\r\n        }\r\n\r\n      }\r\n      \r\n    };\r\n\r\n  }\r\n\r\n}"]}